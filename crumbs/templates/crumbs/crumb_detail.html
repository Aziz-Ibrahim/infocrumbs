{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/crumbs.css' %}">
{% endblock %}

{% block content %}
    <div class="container crumb-container py-5 px-5 gradient-border glow">
        <div class="row">
            <div class="col-12">
                        <h2>{{ crumb.title }}</h2>
        <ul class="list-unstyled list-inline">
            <li class="list-inline-item"><small class="text-muted">Source: {{ crumb.source }}</small></li>
            <li class="list-inline-item"><p class="text-muted"><strong>Topic:</strong> {{ crumb.topic }}</p></li>
            <li class="list-inline-item"><small class="text-muted">Published: {{ crumb.published_at }}</small></li>
        </ul>
        <hr>
        <p>{{ crumb.summary }}</p>
        <ul class="list-unstyled listine">
            <li class="list-inline-item">
                <p>
                    <a 
                    href="{{ crumb.url }}" 
                    target="_blank" 
                    aria-label="Read the full article from the sourecs, opens in a new teb">
                        Read more
                    </a>
                </p>
            </li>
            <li class="list-inline-item">
                <p>
                    <a 
                    href="{% url 'crumb_list' %}" 
                    class="text-right" 
                    aria-label="Return to crumbs list page">
                        <i class="fa-solid fa-circle-left"></i>Back
                    </a>
                </p>
            </li>
            <li class="list-inline-item">
                <button id="save-btn" class="btn btn-sm btn-outline-primary" data-id="{{ crumb.id }}">
                    {% if is_saved %}
                        <i class="fas fa-star"></i> Saved
                    {% else %}
                        <i class="far fa-star"></i> Save
                    {% endif %}
                </button>
            </li>
        </ul>
            </div>
            <div class="col-6" id="comment-form-container">
                <h4>Write a comment</h4>
                {% if user.is_authenticated %}
                    <form action="{% url 'add_comment' crumb.id %}" id="comment-form" method="post">
                        {% csrf_token %}
                        {{ comment_form.as_p }}
                        <button type="submit" class="neon-button">Post Comment</button>
                    </form>
                {% else %}
                    <p><a href="{% url 'account_login' %}" aria-label="link to log in page">Log in</a> to post a comment.</p>
                {% endif %}
            </div>
            <div class="col-6" id="comments">
                <h4>Comments</h4>
                <div id="comments-section">
                    {% include "feedback/includes/comment_list.html" %}
                </div>
            </div>

        </div>
    </div>
{% endblock %}

{% block extra_js %}
    <script src="{% static 'js/comments.js' %}"></script>
    <script src="{% static 'js/saved.js' %}"></script>
{% endblock %}